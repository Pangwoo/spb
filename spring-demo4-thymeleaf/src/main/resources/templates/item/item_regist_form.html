<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/item_layout}">
<head>
	<title>Insert title here</title>
	<!-- 개별페이지 전용 스타일시트 영역 -->
	<th:block layout:fragment="style">
		<link rel="stylesheet" th:href="@{/css/item_main.css}" />
	</th:block>
</head>
<body>
	<th:block layout:fragment="content">
		<h3>상품 등록</h3>
		<div id="registForm">
			<!-- 컨트롤러에서 DTO 객체를 전달받았을 경우 -->
			<!-- form 태그에서 th:object 속성을 사용하여 전달받은 DTO 객체를 선택하면 -->
			<!-- 해당 form 내에서 name 속성 지정 생략도 가능하고, DTO 객체의 값들을 폼에서 사용도 가능함(Validation check 등) -->
			<form th:action="@{/items}" th:object="${item}" method="post">
				<table border="1">
					<tr>
						<th>상품명</th>
						<td>
							<!-- 입력요소 태그에 th:field 속성을 사용하여 해당 입력 요소에 DTO 객체의 필드를 바인딩(name 속성 생략 가능) -->
							<input type="text" th:field="*{itemNm}"> <!-- name 속성값이 자동으로 itemNm 으로 설정됨 -->
							<!-- Validation 체크 실패로 인해 다시 입력 페이지로 돌아왔을 때 실패한 항목에 대한 처리(오류 메세지 표시) -->
							<!-- th:if 활용하여 에러 발생 여부 체크하고, th:error 활용하여 에러 발생에 대한 메세지 출력을 위해 필드 지정 -->
							<!-- 에러 발생 여부는 타임리프 내장객체 fields 객체의 hasError() 메서드 활용(파라미터로 필드명 전달) -->
							<!-- 기본 문법 : th:if="${#fields.hasError('필드명')} th:errors="*{필드명}" -->
							<div th:if="${#fields.hasErrors('itemNm')}" th:errors="*{itemNm}"></div>
						</td>
					</tr>
					<tr>
						<th>가격</th>
						<td>
							<input type="number" th:field="*{price}"> <!-- name 속성값이 자동으로 price 로 설정됨 -->
							<div th:if="${#fields.hasErrors('price')}" th:errors="*{price}"></div>
						</td> 
					</tr>
					<tr>
						<th>재고수량</th>
						<td>
							<input type="number" th:field="*{stockQty}"> <!-- name 속성값이 자동으로 stockQty 로 설정됨 -->
							<div th:if="${#fields.hasErrors('stockQty')}" th:errors="*{stockQty}"></div>
						</td> 
					</tr>
					<tr>
						<th>카테고리</th>
						<td>
							<select th:field="*{category}">
								<option value="">카테고리 선택</option>
								<!-- ItemCategory 의 모든 값을 배열로 전달했으므로 해당 배열(categories)을 반복하여 option 태그 생성 -->
								<!-- 실제 전달될 값(th:value 속성)은 반복되는 enum 상수값을 그대로 사용 -->
								<!-- 화면에 표시될 값(th:text 속성)은 각 상수에 할당된 문자열을 사용하기 위해 label 필드에 접근(enum 에서 설정 추가 필요) -->
<!-- 								<option th:each="cat : ${categories}" -->
								<!-- ItemDTO 객체 내에 ItemCategory enum 값들을 함께 저장했으므로 ${} 대신 *{} 사용 -->
<!-- 								<option th:each="cat : *{categories}" -->
								<!-- 타임리프에서 자바 클래스 직접 참조하는 방법(enum 타입도 가능) : ${T(패키지명.클래스명).메서드명()} -->
								<option th:each="cat : ${T(kr.co.itwillbs.thymeleaf.item.ItemCategory).values()}"
										th:value="${cat}"
										th:text="${cat.label}"></option>
							</select>
							<div th:if="${#fields.hasErrors('category')}" th:errors="*{category}"></div>
						</td>
					</tr>
					<tr>
						<th>판매상태</th>
						<td>
							<select th:field="*{sellStatus}">
								<option value="">판매상태 선택</option>
<!-- 								<option th:each="status : *{sellStatuses}" -->
								<option th:each="status : ${T(kr.co.itwillbs.thymeleaf.item.ItemSellStatus).values()}"
										th:value="${status}"
										th:text="${status.label}"></option>
							</select>
							<div th:if="${#fields.hasErrors('sellStatus')}" th:errors="*{sellStatus}"></div>
						</td>
					</tr>
					<tr>
						<th>상세설명</th>
						<td>
							<!-- 텍스트에어리어도 동일한 방식으로 th:field 속성 적용 가능 -->
							<textarea th:field="*{itemDetail}" rows="4" cols="20"></textarea>
							<div th:if="${#fields.hasErrors('itemDetail')}" th:errors="*{itemDetail}"></div>
						</td>
					</tr>
					<tr>
						<td colspan="2"><input type="submit" value="등록"></td>
					</tr>
				</table>
			</form>
		</div>
	</th:block>
	
	<!-- 레이아웃 내의 script 프래그먼트 영역에 추가될 스크립트 -->
	<th:block layout:fragment="script">
		<script th:src="@{/js/item_main.js}"></script>
		<script>
			console.log("레지스트 실행됨!");
		</script>
	</th:block>
</body>
</html>















